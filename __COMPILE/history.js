/*Copyright 2011-2013, Dmitriy Pakhtinov ( spb.piksel@gmail.com ) and github.com/termi */
void function(){var l=void 0,p=null,q=!1;function M(a){if(!a.__history_shim__){var n=h();if(B)return C=n.a,B=0;var c=a.oldURL||C;a=C=a.newURL||n.a;var n=c.replace(/^.*?(#|$)/,""),b=a.replace(/^.*?(#|$)/,"");c!=a&&!D&&t(l);r=D=0;n!=b&&t(2,c,a)}}function W(a){var n=a||q,c=n.target||q;a=n.defaultPrevented;if(c&&("A"===c.nodeName&&!a)&&(a=h(c.getAttribute("href",2),!0),a.b&&"#"!==a.b&&a.b===a.a.replace(h().a.split("#").shift(),""))){history.location.hash=a.b;a=a.b.replace(/^#/,"");if((c=document.getElementById(a))&&c.id===a&&
"A"===c.nodeName)c=c.getBoundingClientRect(),window.scrollTo(E.scrollLeft||0,c.top+(E.scrollTop||0)-(E.clientTop||0));n.preventDefault()}}function F(a){r===d.href&&(a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation(),r=0);e.removeEventListener("popstate",F,q);F=p}function t(a,n,c){var b=new u(2==a?"hashchange":3==a?"pagechange":"popstate");n!=l&&(b.oldUrl=n);c!=l&&(b.newUrl=c);b.__history_shim__=!0;if(!m&&a==l&&e.onpopstate)e.onpopstate(b);e.dispatchEvent(b)}function G(a){return x?
a?x.setItem("__history_shim__",X(a)):Y(x.getItem("__history_shim__"))||{}:{}}function y(a,b,c){return z?(z(a,b),a):c?a:l}var e=this,b=e.JSON||{},Y=b.parse,X=b.stringify,H=document,E=H.documentElement,u=e.j,f=Function.prototype.bind||q,N=f.call(Function.prototype.call,Object.prototype.hasOwnProperty),s=e.history||{},f=(b=e.history)&&(b=b.__proto__||(b=b.constructor)&&b.prototype)&&b&&b!=Object.prototype&&b||e.history,d=e.location,m="pushState"in s,Z=m&&s.state===l,r=d.href,O=s.pushState,P=s.replaceState,
x=e.sessionStorage,z;if(b=Object.defineProperty&&function(a,b){var c,d;for(d in b)N(b,d)&&(c=b[d],"object"!=typeof c&&(c={value:c}),"configurable"in c||(c.configurable=!0),Object.defineProperty(a,d,c))}){try{b(f,{_:{get:function(){return 1},configurable:!0}})}catch(ba){b=p}1!==f._&&(b=p);"_"in f&&delete f._}!b&&f.__defineGetter__&&(b=function(a,b){var c,d;if(a.__defineGetter__)for(d in b)N(b,d)&&(c=b[d],c.get&&a.__defineGetter__(d,c.get),c.set&&a.__defineSetter__(d,c.set));return a});z=b;var I=l,
B=0,$=/[^\/]+$/g,Q=location.pathname.split("#")[0].split("?")[0],h,g=H.createElement("a"),R,J,S,K,A,v,j,aa=/^[^#]*/;h=function(a,b){if(a){if(!m||I){var c=h(),e=c.e,f=c.i,k=a.charAt(0);a=/^(?:[\w0-9]+\:)?\/\//.test(a)?"/"==k?f+a:a:f+"//"+c.h+("/"==k?a:"?"==k?e+a:"#"==k?e+c.f+a:e.replace($,"")+a)}}else if(a=d.href,!m||b)a=d.protocol+"//"+d.host+(-1!=a.indexOf("#")?"/":Q)+(a.replace(aa,"")||"#").replace(/^#[\/]?(?:\/)?/,"");if(R!==a){g.href=R=a;v=g.port;A=g.host;j=g.pathname;if("http:"===g.protocol&&
80==v||"https:"===g.protocol&&443==v)A=g.hostname,v="";j="/"==j.charAt(0)?j:"/"+j;J=j+g.search+g.hash;K=j+g.search;S=K+g.hash}return{a:g.protocol+"//"+A+J,i:g.protocol,h:A,k:g.hostname||d.hostname,l:v||d.port,e:j,f:g.search,b:g.hash,d:J,c:K,g:S}};var f=!I&&f,b={state:{get:function(){return G()[this.location.href]||p}},length:{get:function(){return s.length}},location:{set:function(a){e.location.href=a},get:function(){return m?d:L}}},L={assign:function(a){d.assign(m||0!==a.indexOf("#")?a:"#"+h().c+
a)},reload:d.reload,replace:function(a){d.replace(m||0!==a.indexOf("#")?a:"#"+h().c+a)},toString:function(){return this.href}},T={href:{set:function(a){d.href=a},get:function(){return h().a}},protocol:{set:function(a){d.protocol=a},get:function(){return d.protocol}},host:{set:function(a){d.host=a},get:function(){return d.host}},hostname:{set:function(a){d.hostname=a},get:function(){return d.hostname}},port:{set:function(a){d.port=a},get:function(){return d.port}},pathname:{set:function(a){d.pathname=
a},get:function(){return h().e}},search:{set:function(a){d.search=a},get:function(){return h().f}},hash:{set:function(a){a=0===a.indexOf("#")?a:"#"+a;var b=h();d.hash="#"+b.c+a},get:function(){return h().b}},origin:{}},U=e.onpopstate||p,w=e.onhashchange,D=0,V=h(),C=V.a;e.addEventListener("hashchange",M,q);w===l&&setInterval(function(){M({})},100);w||(w=p);e.addEventListener&&(e.addEventListener("popstate",F,q),e.addEventListener("popstate",function(){r=0;D=1},q));f&&y(f,s.state===l?{state:b.state,
location:b.location}:{location:b.location});L=y(L,T);"onpopstate"in e||y(e,{onhashchange:{get:function(){return w},set:function(a){w=a||p}},onpopstate:{get:function(){return U},set:function(a){if(U=a||p)if(!m&&r&&!(r=0)&&V.d!==Q)clearInterval(p),setTimeout(t,10)}}},!0);m||document.addEventListener("click",W,q);try{new u("click")}catch(ca){u=p}u||(u=function(a){var b;b=H.createEvent("Events");b.initEvent(a,q,q);return b});f.pushState=function(a,b,c,e){var f=G(),g=h().a,j=c&&h(c);r=0;c=j?j.a:g;e&&f[g]&&
delete f[g];if((!m||Z)&&x&&a)f[c]=a,G(f),a=p;O&&P?e?P.call(this,a,b,c):O.call(this,a,b,c):j&&j.d!=h().d&&(B=1,e?d.replace("#"+j.g):d.hash=j.g);a=h().c;if(!k||k!=a)t(3,k,a),k=a};f.replaceState=function(a,b,c){this.pushState(a,b,c,1)};f.emulate=!m;var k="",b=function(){var a=h().c;if(!k||k!=a)t(3,k,a),k=a};e.addEventListener("popstate",b);e.addEventListener("hashchange",b);if(e.opera&&m&&(b=document.createElement("a"),f=b.__proto__))(b=Object.getOwnPropertyDescriptor(b,"href"))&&"get"in b&&Object.defineProperty(f,
"href",function(a){this.get=function(){var b=this.getAttribute("href"),c;return b&&"/"==b[0]?(c=e.location,c=c.protocol+"//"+c.host,c+b):a.call(this)};return this}.call(b,b.get));b=I=y=z=f=b=T=f=f=p}.call(window);
