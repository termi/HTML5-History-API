/*Copyright 2011-2013, Dmitriy Pakhtinov ( spb.piksel@gmail.com ) and github.com/termi */
void function(){var m=void 0,r=null,s=!1;function u(a,v,b){var d=new x(2==a?"hashchange":3==a?"pagechange":"popstate");v!=m&&(d.oldUrl=v);b!=m&&(d.newUrl=b);d.__history_shim__=!0;if(!p&&a==m&&c.onpopstate)c.onpopstate(d);c.dispatchEvent(d)}function A(a){return y?a?y.setItem("__hitoryapi__",K(a)):L(y.getItem("__hitoryapi__"))||{}:{}}function z(a,b,d){try{if(1!==Object.defineProperty({},"t",{get:function(){return 1}}).t)throw Error;Object.defineProperties(a,b)}catch(c){if(a.__defineGetter__)for(var f in b)M(b,f)&&(a.__defineGetter__(f,
b[f].get),b[f].set&&a.__defineSetter__(f,b[f].set));if(d)return s}return a}var c=this,e=c.JSON||{},B=document,C=B.documentElement,x=c.j,M=(Function.prototype.bind||s).call(Function.prototype.call,Object.prototype.hasOwnProperty),j=c.history||{},b=c.location,p="pushState"in j,N=p&&j.state===m,q=b.href,F=j.pushState,G=j.replaceState,L=e.parse,K=e.stringify,y=c.sessionStorage,H=c.eval&&eval("/*@cc_on 1;@*/")&&+((/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0)||m,e=m,D=0,O=/[^\/]+$/g,I=location.pathname.split("#")[0].split("?")[0],
d=function(a){var c,w,e,f,t,k,n,P=/^[^#]*/;return function(g,Q){if(g){if(!p||H){var l=d(),h=l.e,q=l.i,j=g.charAt(0);g=/^(?:[\w0-9]+\:)?\/\//.test(g)?"/"==j?q+g:g:q+"//"+l.h+("/"==j?g:"?"==j?h+g:"#"==j?h+l.f+g:h.replace(O,"")+g)}}else if(g=b.href,!p||Q)g=b.protocol+"//"+b.host+(-1!=g.indexOf("#")?"/":I)+(g.replace(P,"")||"#").replace(/^#[\/]?(?:\/)?/,"");if(c!==g){a.href=c=g;k=a.port;t=a.host;n=a.pathname;if("http:"===a.protocol&&80==k||"https:"===a.protocol&&443==k)t=a.hostname,k="";n="/"==n.charAt(0)?
n:"/"+n;w=n+a.search+a.hash;f=n+a.search;e=f+a.hash}return{a:a.protocol+"//"+t+w,i:a.protocol,h:t,k:a.hostname||b.hostname,l:k||b.port,e:n,f:a.search,b:a.hash,d:w,c:f,g:e}}}(B.createElement("a")),l=!e&&j||s,R={get:function(){return A()[l.location.href]||r}},J={set:function(a){c.location=a},get:function(){return p?b:E}},E={assign:function(a){b.assign(p||0!==a.indexOf("#")?a:"#"+d().c+a)},reload:b.reload,replace:function(a){b.replace(p||0!==a.indexOf("#")?a:"#"+d().c+a)},toString:function(){return this.href}},
S={href:{set:function(a){b.href=a},get:function(){return d().a}},protocol:{set:function(a){b.protocol=a},get:function(){return b.protocol}},host:{set:function(a){b.host=a},get:function(){return b.host}},hostname:{set:function(a){b.hostname=a},get:function(){return b.hostname}},port:{set:function(a){b.port=a},get:function(){return b.port}},pathname:{set:function(a){b.pathname=a},get:function(){return d().e}},search:{set:function(a){b.search=a},get:function(){return d().f}},hash:{set:function(a){a=
0===a.indexOf("#")?a:"#"+a;var c=d();b.hash="#"+c.c+a},get:function(){return d().b}},origin:{}};(function(){function a(a){if(!a.__history_shim__){var b=d();if(D)return n=b.a,D=0;var c=a.oldURL||n;a=n=a.newURL||b.a;var b=c.replace(/^.*?(#|$)/,""),f=a.replace(/^.*?(#|$)/,"");c!=a&&!h&&u(m);q=h=0;b!=f&&u(2,c,a)}}function v(a){q===b.href&&(a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation(),q=0);c.removeEventListener("popstate",v,s)}function w(a){var b=a||s,c=b.target||s;a=b.defaultPrevented;
if(c&&("A"===c.nodeName&&!a)&&(a=d(c.getAttribute("href",2),!0),a.b&&"#"!==a.b&&a.b===a.a.replace(d().a.split("#").shift(),""))){history.location.hash=a.b;a=a.b.replace(/^#/,"");if((c=document.getElementById(a))&&c.id===a&&"A"===c.nodeName)c=c.getBoundingClientRect(),window.scrollTo(C.scrollLeft||0,c.top+(C.scrollTop||0)-(C.clientTop||0));b.preventDefault()}}var e=c.onpopstate||r,f=c.onhashchange||r,h=0,k=d(),n=k.a;c.addEventListener("hashchange",a,s);c.addEventListener&&(c.addEventListener("popstate",
v,s),c.addEventListener("popstate",function(){q=0;h=1},s));l=z(l,j.state===m?{state:R,location:J}:{location:J});E=z(E,S);"onpopstate"in c||z(c,{onhashchange:{get:function(){return f},set:function(a){f=a||r}},onpopstate:{get:function(){return e},set:function(a){if(e=a||r)if(!p&&q&&!(q=0)&&k.d!==I)clearInterval(r),setTimeout(u,10)}}},!0);p||document.addEventListener("click",w,s);return a})();try{new x("click")}catch(T){x=r}x||(x=function(a){var b;b=B.createEvent("Events");b.initEvent(a,s,s);return b});
l.pushState=function(a,c,e,j){var f=A(),t=d().a,k=e&&d(e);q=0;e=k?k.a:t;j&&f[t]&&delete f[t];if((!p||N)&&y&&a)f[e]=a,A(f),a=r;F&&G?j?G.call(l,a,c,e):F.call(l,a,c,e):k&&k.d!=d().d&&(D=1,j?b.replace("#"+k.g):b.hash=k.g);a=d().c;if(!h||h!=a)u(3,h,a),h=a};l.replaceState=function(a,b,c){l.pushState(a,b,c,1)};l.emulate=!p;var h="",e=function(){var a=d().c;if(!h||h!=a)u(3,h,a),h=a};c.addEventListener("popstate",e);c.addEventListener("hashchange",e);e=H=e=z=m}.call(window);
