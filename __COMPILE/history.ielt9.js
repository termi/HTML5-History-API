/*Copyright 2011-2013, Dmitriy Pakhtinov ( spb.piksel@gmail.com ) and github.com/termi */
void function(){var t=void 0,u=null,v=!1;function B(a,b,c){var g=new C(2==a?"hashchange":3==a?"pagechange":"popstate");b!=t&&(g.oldUrl=b);c!=t&&(g.newUrl=c);g.__history_shim__=!0;if(!s&&a==t&&d.onpopstate)d.onpopstate(g);if(d.dispatchEvent)d.dispatchEvent(g);else{var e,l;for(l in y)y.hasOwnProperty(l)&&(typeof(e=y[l])=="function"||e&&"object"==typeof e&&(e=e.handleEvent))&&e.call(d,g)}}function M(a){return F?a?F.setItem("__hitoryapi__",q(a)):G(F.getItem("__hitoryapi__"))||{}:{}}function H(a,b,c){var g=a,e,l=v;try{if(1!==
Object.defineProperty({},"t",{get:function(){return 1}}).t)throw Error;Object.defineProperties(a,b)}catch(h){if(a.__defineGetter__)for(var m in b)I(b,m)&&(a.__defineGetter__(m,b[m].get),b[m].set&&a.__defineSetter__(m,b[m].set));if(c)return v;l=!0}if(!c&&l&&z){c="StaticClass"+R+z++;g=["Class "+c];"execVB"in d||execScript("Function execVB(c) ExecuteGlobal(c) End Function","VBScript");"VBCVal"in d||execScript("Function VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");
for(e in a)g.push("Public ["+e+"]");I(a,"toString")&&(a.propertyIsEnumerable("toString")||g.push("Public [toString]"),b["(toString)"]={get:function(){return this.toString.call(this)}});for(e in b)I(b,e)&&(b[e].get&&(a["get "+e]=b[e].get,g.push("Public [get "+e+"]","Public "+("(toString)"===e?"Default ":"")+"Property Get ["+e+"]","Call VBCVal(me.[get "+e+"].call(me),["+e+"])","End Property")),b[e].set&&(a["set "+e]=b[e].set,g.push("Public [set "+e+"]","Public Property Let ["+e+"](v)","Call me.[set "+
e+"].call(me,v)","End Property","Public Property Set ["+e+"](v)","Call me.[set "+e+"].call(me,v)","End Property")));g.push("End Class","Function "+c+"Factory()","Set "+c+"Factory=New "+c,"End Function");execVB(g.join("\n"));g=d[c+"Factory"]();for(e in a)g[e]=a[e];I(a,"toString")&&(g.toString=a.toString)}return g}var d=this,n=d.JSON||{},w=document,J=w.documentElement,C=d.j,N=Function.prototype.bind||function(a,b){var c=this,d=S.call(arguments,1);return function(){return _Function_apply.call(c,a,d.concat(S.call(arguments)))}},
S=Array.prototype.slice,O=Function.prototype.call,I=N.call(O,Object.prototype.hasOwnProperty),p=d.history||{},h=d.location,s="pushState"in p,X=s&&p.state===t,A=h.href,T=p.pushState,U=p.replaceState,G=n.parse,q=n.stringify,F=d.sessionStorage,E=d.eval&&eval("/*@cc_on 1;@*/")&&+((/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0)||t,R=(new Date).getTime(),z=!E||8<E?0:1,f=8>E?w.createElement("iframe"):0,y,P=0,Y=/[^\/]+$/g,V=location.pathname.split("#")[0].split("?")[0],j=function(a){var b,c,d,e,l,D,
m,f=/^[^#]*/,r=/^(?:[a-z]+\:)?\/\//;return function(k,Z){if(k){if(!s||E){var K=j(),p=K.f,q=K.i,n=k.charAt(0);k=r.test(k)?"/"==n?q+k:k:q+"//"+K.h+("/"==n?k:"?"==n?p+k:"#"==n?p+K.g+k:p.replace(Y,"")+k)}}else if(k=h.href,!s||Z)k=h.protocol+"//"+h.host+(-1!=k.indexOf("#")?"/":V)+(k.replace(f,"")||"#").replace(/^#[\/]?(?:\/)?/,"");if(b!==k){a.href=b=k;D=a.port;l=a.host;m=a.pathname;if("http:"===a.protocol&&80==D||"https:"===a.protocol&&443==D)l=a.hostname,D="";m="/"==m.charAt(0)?m:"/"+m;c=m+a.search+a.hash;
e=m+a.search;d=e+a.hash}return{a:a.protocol+"//"+l+c,i:a.protocol,h:l,k:a.hostname||h.hostname,l:D||h.port,f:m,g:a.search,b:a.hash,e:c,c:e,d:d}}}(w.createElement("a")),r=!z&&p||{back:p.back,forward:p.forward,go:p.go,pushState:t,replaceState:t,emulate:!s,toString:function(){return"[object History]"}},L={state:{get:function(){return f&&f.storage||M()[r.location.href]||u}},length:{get:function(){return p.length}},location:{set:function(a){d.location=a},get:function(){return s?h:Q}}},Q={assign:function(a){h.assign(s||
0!==a.indexOf("#")?a:"#"+j().c+a)},reload:h.reload,replace:function(a){h.replace(s||0!==a.indexOf("#")?a:"#"+j().c+a)},toString:function(){return this.href}},$={href:{set:function(a){h.href=a},get:function(){return j().a}},protocol:{set:function(a){h.protocol=a},get:function(){return h.protocol}},host:{set:function(a){h.host=a},get:function(){return h.host}},hostname:{set:function(a){h.hostname=a},get:function(){return h.hostname}},port:{set:function(a){h.port=a},get:function(){return h.port}},pathname:{set:function(a){h.pathname=
a},get:function(){return j().f}},search:{set:function(a){h.search=a},get:function(){return j().g}},hash:{set:function(a){a=0===a.indexOf("#")?a:"#"+a;var b=j();f?a!=b.b&&(r.pushState(u,u,b.c+a),W({oldURL:b.a})):h.hash="#"+b.c+a},get:function(){return j().b}},origin:{}},W=function(){function a(a){if(!a.__history_shim__){var b=j();if(P)return q=b.a,P=0;var d=a.oldURL||q;a=q=a.newURL||b.a;var b=d.replace(/^.*?(#|$)/,""),c=a.replace(/^.*?(#|$)/,"");d!=a&&!f&&B(t);A=f=0;b!=c&&B(2,d,a)}}function b(){if(A&&
!(A=0)&&n.e!==V)clearInterval(m),setTimeout(B,10)}function c(a){A===h.href&&(a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation(),A=0);d.removeEventListener("popstate",c,v)}function g(a){var b=a||d.event,c=b.target||b.srcElement;a="defaultPrevented"in b?b.defaultPrevented:b.returnValue===v;if(c&&("A"===c.nodeName&&!a)&&(a=j(c.getAttribute("href",2),!0),a.b&&"#"!==a.b&&a.b===a.a.replace(j().a.split("#").shift(),""))){history.location.hash=a.b;a=a.b.replace(/^#/,"");if((c=document.getElementById(a))&&
c.id===a&&"A"===c.nodeName)c=c.getBoundingClientRect(),window.scrollTo(J.scrollLeft||0,c.top+(J.scrollTop||0)-(J.clientTop||0));b.preventDefault?b.preventDefault():b.returnValue=v}}var e=d.onpopstate||u,l=d.onhashchange||u,f=0,m=u,n=j(),q=n.a;d.addEventListener?d.addEventListener("hashchange",a,v):d.attachEvent("onhashchange",a);d.addEventListener&&(d.addEventListener("popstate",c,v),d.addEventListener("popstate",function(){A=0;f=1},v));r=H(r,z?L:p.state===t?{state:L.state,location:L.location}:{location:L.location});
Q=H(Q,$);z&&execScript("Public history, onhashchange","VBScript");!("onpopstate"in d||H(d,{onhashchange:{get:function(){return l},set:function(a){l=a||u}},onpopstate:{get:function(){return e},set:function(a){(e=a||u)&&!s&&b()}}},!0))&&!s&&(m=setInterval(function(){d.onpopstate&&b()},100));s||(document.addEventListener?document.addEventListener("click",g,v):document.attachEvent("onclick",g));return a}();q||(q=function(a,b,c){for(b in(c="[object Object]"==a&&[])&&a)c.push(q(b)+":"+q(a[b]));return""+
a===a?'"'+a+'"':a&&a.map?"["+a.map(q)+"]":c?"{"+c+"}":a});G||(G=function(a){return a?(new Function("return "+a))():u});try{new C("click")}catch(aa){C=u}C||(C=function(a){var b;w.createEvent?(b=w.createEvent("Events"),b.initEvent(a,v,v)):(b=w.createEventObject(),b.type=a);return b});d.addEventListener||(y={},d.attachEvent=N.call(function(a,b,c){if("popstate"==b||"hashchange"==b||"pagechange"==b){if(!(a=y[b]))a=y[b]={};if(!(b=c.uuid))b=c.uuid="_"+ +new Date;a[b]||(a[b]=c)}else O.call(a,d,b,c)},d,d.attachEvent),
d.detachEvent=N.call(function(a,b,c){var g;"popstate"==b||"hashchange"==b||"pagechange"==b?(a=c.uuid)&&(g=y[b])&&delete g[a]:O.call(a,d,b,c)},d,d.detachEvent));r.pushState=function(a,b,c,d){var e=M(),l=j().a,f=c&&j(c);A=0;c=f?f.a:l;d&&e[l]&&delete e[l];if((!s||X)&&F&&a)e[c]=a,M(e),a=u;T&&U?d?U.call(r,a,b,c):T.call(r,a,b,c):f&&f.e!=j().e&&(P=1,d?h.replace("#"+f.d):h.hash=f.d);a=j().c;if(!x||x!=a)B(3,x,a),x=a};r.replaceState=function(a,b,c){r.pushState(a,b,c,1)};z?(d.history=r,function(a,b){var c,g;if(f&&
(g=function(){var a=j().a;b!=a&&W({oldURL:b,newURL:b=a})},c=setInterval(g,100),f.src="javascript:true;",f=J.firstChild.appendChild(f).contentWindow,r.pushState=function(a,d,e,n,p){var k=f.document;if(e=e&&j(e)){p||clearInterval(c);if(n)f.lfirst?(history.back(),r.pushState(a,d,e.a,0,1)):(f.storage=a,h.replace("#/"+e.d));else if(e.a!=b||p)f.lfirst||(f.lfirst=1,r.pushState(f.storage,d,b,0,1)),a=["<script>","lfirst=1;",,"storage="+q(a)+";","\x3c/script>"],a[2]='parent.location.hash="'+e.d.replace(/"/g,
'\\"')+'";',k.open(),k.write(a.join("")),k.close();p||(b=j().a,c=setInterval(g,100))}else f.storage=a},d.attachEvent("unload",function(){if(f.storage){var a={};a[j().a]=f.storage;w.cookie="_historyAPI="+escape(q(a))}clearInterval(c)}),1<a.length)){a=unescape(a.pop().split(";").shift());try{f.storage=G(a)[j().a]}catch(e){}}}(w.cookie.split("_historyAPI="),j().a)):d.history.emulate=!s;var x="",n=function(){var a=j().c;if(!x||x!=a)B(3,x,a),x=a};d.addEventListener?(d.addEventListener("popstate",n),d.addEventListener("hashchange",
n)):(d.attachEvent("popstate",n),d.attachEvent("hashchange",n));n=E=R=z=H=t}.call(window);
