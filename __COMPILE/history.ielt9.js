/*Copyright 2011-2013, Dmitriy Pakhtinov ( spb.piksel@gmail.com ) and github.com/termi */
void function(){var t=void 0,u=null,v=!1;function A(a,b,g){var e=new B(2==a?"hashchange":3==a?"pagechange":"popstate");b!=t&&(e.oldUrl=b);g!=t&&(e.newUrl=g);e.__history_shim__=!0;if(!s&&a==t&&c.onpopstate)c.onpopstate(e);if(c.dispatchEvent)c.dispatchEvent(e);else{var d,m;for(m in x)x.hasOwnProperty(m)&&(typeof(d="function"==x[m])||d&&"object"==typeof d&&(d=d.handleEvent))&&d.call(c,e)}}function J(a){return E?a?E.setItem("__hitoryapi__",K(a)):P(E.getItem("__hitoryapi__"))||{}:{}}function F(a,b,g){var e=a,d,m=v;try{if(1!==
Object.defineProperty({},"t",{get:function(){return 1}}).t)throw Error;Object.defineProperties(a,b)}catch(h){if(a.__defineGetter__)for(var n in b)G(b,n)&&(a.__defineGetter__(n,b[n].get),b[n].set&&a.__defineSetter__(n,b[n].set));if(g)return v;m=!0}if(!g&&m&&y){g="StaticClass"+Q+y++;e=["Class "+g];"execVB"in c||execScript("Function execVB(c) ExecuteGlobal(c) End Function","VBScript");"VBCVal"in c||execScript("Function VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");
for(d in a)e.push("Public ["+d+"]");G(a,"toString")&&(a.propertyIsEnumerable("toString")||e.push("Public [toString]"),b["(toString)"]={get:function(){return this.toString.call(this)}});for(d in b)G(b,d)&&(b[d].get&&(a["get "+d]=b[d].get,e.push("Public [get "+d+"]","Public "+("(toString)"===d?"Default ":"")+"Property Get ["+d+"]","Call VBCVal(me.[get "+d+"].call(me),["+d+"])","End Property")),b[d].set&&(a["set "+d]=b[d].set,e.push("Public [set "+d+"]","Public Property Let ["+d+"](v)","Call me.[set "+
d+"].call(me,v)","End Property","Public Property Set ["+d+"](v)","Call me.[set "+d+"].call(me,v)","End Property")));e.push("End Class","Function "+g+"Factory()","Set "+g+"Factory=New "+g,"End Function");execVB(e.join("\n"));e=c[g+"Factory"]();for(d in a)e[d]=a[d];G(a,"toString")&&(e.toString=a.toString)}return e}var c=this,l=c.JSON||{},p=document,V=p.documentElement,B=c.j,L=Function.prototype.bind||v,M=Function.prototype.call,G=L.call(M,Object.prototype.hasOwnProperty),r=c.history||{},h=c.location,
s="pushState"in r,W=s&&r.state===t,z=h.href,R=r.pushState,S=r.replaceState,P=l.parse,K=l.stringify,E=c.sessionStorage,D=c.eval&&eval("/*@cc_on 1;@*/")&&+((/msie (\d+)/i.exec(navigator.userAgent)||[])[1]||0)||t,Q=(new Date).getTime(),y=!D||8<D?0:1,f=8>D?p.createElement("iframe"):0,x,N=0,X=/[^\/]+$/g,T=location.pathname.split("#")[0].split("?")[0],j=function(a){var b,c,e,d,m,C,n,f=/^[^#]*/,q=/^(?:[a-z]+\:)?\/\//;return function(k,Y){if(k){if(!s||D){var H=j(),r=H.f,l=H.i,p=k.charAt(0);k=q.test(k)?"/"==
p?l+k:k:l+"//"+H.h+("/"==p?k:"?"==p?r+k:"#"==p?r+H.g+k:r.replace(X,"")+k)}}else if(k=h.href,!s||Y)k=h.protocol+"//"+h.host+(-1!=k.indexOf("#")?"/":T)+(k.replace(f,"")||"#").replace(/^#[\/]?(?:\/)?/,"");if(b!==k){a.href=b=k;C=a.port;m=a.host;n=a.pathname;if("http:"===a.protocol&&80==C||"https:"===a.protocol&&443==C)m=a.hostname,C="";n="/"==n.charAt(0)?n:"/"+n;c=n+a.search+a.hash;d=n+a.search;e=d+a.hash}return{a:a.protocol+"//"+m+c,i:a.protocol,h:m,k:a.hostname||h.hostname,l:C||h.port,f:n,g:a.search,
b:a.hash,e:c,c:d,d:e}}}(p.createElement("a")),q=!y&&r||{back:r.back,forward:r.forward,go:r.go,pushState:t,replaceState:t,emulate:!s,toString:function(){return"[object History]"}},I={state:{get:function(){return f&&f.storage||J()[q.location.href]||u}},length:{get:function(){return r.length}},location:{set:function(a){c.location=a},get:function(){return s?h:O}}},O={assign:function(a){h.assign(s||0!==a.indexOf("#")?a:"#"+j().c+a)},reload:h.reload,replace:function(a){h.replace(s||0!==a.indexOf("#")?a:
"#"+j().c+a)},toString:function(){return this.href}},Z={href:{set:function(a){h.href=a},get:function(){return j().a}},protocol:{set:function(a){h.protocol=a},get:function(){return h.protocol}},host:{set:function(a){h.host=a},get:function(){return h.host}},hostname:{set:function(a){h.hostname=a},get:function(){return h.hostname}},port:{set:function(a){h.port=a},get:function(){return h.port}},pathname:{set:function(a){h.pathname=a},get:function(){return j().f}},search:{set:function(a){h.search=a},get:function(){return j().g}},
hash:{set:function(a){a=0===a.indexOf("#")?a:"#"+a;var b=j();f?a!=b.b&&(q.pushState(u,u,b.c+a),U({oldURL:b.a})):h.hash="#"+b.c+a},get:function(){return j().b}},origin:{}},U=function(){function a(a){if(!a.__history_shim__){var b=j();if(N)return l=b.a,N=0;var c=a.oldURL||l;a=l=a.newURL||b.a;var b=c.replace(/^.*?(#|$)/,""),d=a.replace(/^.*?(#|$)/,"");c!=a&&!f&&A(t);z=f=0;b!=d&&A(2,c,a)}}function b(){if(z&&!(z=0)&&p.e!==T)clearInterval(n),setTimeout(A,10)}function g(a){z===h.href&&(a.stopImmediatePropagation?
a.stopImmediatePropagation():a.stopPropagation(),z=0);c.removeEventListener("popstate",g,v)}function e(a){var b=a||c.event,d=b.target||b.srcElement;a="defaultPrevented"in b?b.defaultPrevented:b.returnValue===v;if(d&&("A"===d.nodeName&&!a)&&(a=j(d.getAttribute("href",2),!0),a.b&&"#"!==a.b&&a.b===a.a.replace(j().a.split("#").shift(),""))){history.location.hash=a.b;a=a.b.replace(/^#/,"");if((d=document.getElementById(a))&&d.id===a&&"A"===d.nodeName)d=d.getBoundingClientRect(),window.scrollTo(documentElement.scrollLeft||
0,d.top+(documentElement.scrollTop||0)-(documentElement.clientTop||0));b.preventDefault?b.preventDefault():b.returnValue=v}}var d=c.onpopstate||u,m=c.onhashchange||u,f=0,n=u,p=j(),l=p.a;c.addEventListener?c.addEventListener("hashchange",a,v):c.attachEvent("onhashchange",a);c.addEventListener&&(c.addEventListener("popstate",g,v),c.addEventListener("popstate",function(){z=0;f=1},v));q=F(q,y?I:r.state===t?{state:I.state,location:I.location}:{location:I.location});O=F(O,Z);y&&execScript("Public history, onhashchange",
"VBScript");!("onpopstate"in c||F(c,{onhashchange:{get:function(){return m},set:function(a){m=a||u}},onpopstate:{get:function(){return d},set:function(a){(d=a||u)&&!s&&b()}}},!0))&&!s&&(n=setInterval(function(){c.onpopstate&&b()},100));s||(document.addEventListener?document.addEventListener("click",e,v):document.attachEvent("onclick",e));return a}();try{new B("click")}catch($){B=u}B||(B=function(a){var b;p.createEvent?(b=p.createEvent("Events"),b.initEvent(a,v,v)):(b=p.createEventObject(),b.type=
a);return b});c.addEventListener||(x={},c.attachEvent=L(function(a,b,g){if("popstate"==b||"hashchange"==b||"mailru.pagechange"==b){if(!(a=x[b]))a=x[b]={};if(!(b=g.uuid))b=g.uuid="_"+ +new Date;a[b]||(a[b]=g)}else M.call(a,c,b,g)},c.attachEvent),c.detachEvent=L(function(a,b,g){var e;"popstate"==b||"hashchange"==b||"mailru.pagechange"==b?(a=g.uuid)&&(e=x[b])&&delete e[a]:M.call(a,c,b,g)},c.detachEvent));q.pushState=function(a,b,c,e){var d=J(),m=j().a,f=c&&j(c);z=0;c=f?f.a:m;e&&d[m]&&delete d[m];if((!s||
W)&&E&&a)d[c]=a,J(d),a=u;R&&S?e?S.call(q,a,b,c):R.call(q,a,b,c):f&&f.e!=j().e&&(N=1,e?h.replace("#"+f.d):h.hash=f.d);a=j().c;if(!w||w!=a)A(3,w,a),w=a};q.replaceState=function(a,b,c){q.pushState(a,b,c,1)};y?(c.history=q,function(a,b){var g,e;if(f&&(e=function(){var a=j().a;b!=a&&U({oldURL:b,newURL:b=a})},g=setInterval(e,100),f.src="javascript:true;",f=V.firstChild.appendChild(f).contentWindow,q.pushState=function(a,c,d,p,l){var k=f.document;if(d=d&&j(d)){l||clearInterval(g);if(p)f.lfirst?(history.back(),
q.pushState(a,c,d.a,0,1)):(f.storage=a,h.replace("#/"+d.d));else if(d.a!=b||l)f.lfirst||(f.lfirst=1,q.pushState(f.storage,c,b,0,1)),a=["<script>","lfirst=1;",,"storage="+K(a)+";","\x3c/script>"],a[2]='parent.location.hash="'+d.d.replace(/"/g,'\\"')+'";',k.open(),k.write(a.join("")),k.close();l||(b=j().a,g=setInterval(e,100))}else f.storage=a},c.attachEvent("unload",function(){if(f.storage){var a={};a[j().a]=f.storage;p.cookie="_historyAPI="+escape(K(a))}clearInterval(g)}),1<a.length)){a=unescape(a.pop().split(";").shift());
try{f.storage=P(a)[j().a]}catch(d){}}}(p.cookie.split("_historyAPI="),j().a)):c.history.emulate=!s;var w="",l=function(){var a=j().c;if(!w||w!=a)A(3,w,a),w=a};c.addEventListener?(c.addEventListener("popstate",l),c.addEventListener("hashchange",l)):(c.attachEvent("popstate",l),c.attachEvent("hashchange",l));l=D=Q=y=F=t}.call(window);
