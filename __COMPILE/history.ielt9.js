/*Copyright 2011-2013, Dmitriy Pakhtinov ( spb.piksel@gmail.com ) and github.com/termi */
void function(){var l=void 0,n=!0,q=null,w=!1;function J(a){if(!a.__history_shim__){var e=h();if(K)return L=e.a,K=0;var c=a.oldURL||L;a=L=a.newURL||e.a;var e=c.replace(/^.*?(#|$)/,""),b=a.replace(/^.*?(#|$)/,"");c!=a&&!M&&z(l);t=M=0;e!=b&&z(2,c,a)}}function V(){if(t&&!(t=0)&&W.d!==X)clearInterval(Y),setTimeout(z,10)}function Z(a){var e=a||b.event,c=e.target||e.srcElement;a="defaultPrevented"in e?e.defaultPrevented:e.returnValue===w;if(c&&("A"===c.nodeName&&!a)&&(a=h(c.getAttribute("href",2),n),a.b&&"#"!==a.b&&a.b===a.a.replace(h().a.split("#").shift(),
""))){history.location.hash=a.b;a=a.b.replace(/^#/,"");if((c=document.getElementById(a))&&c.id===a&&"A"===c.nodeName)c=c.getBoundingClientRect(),window.scrollTo(N.scrollLeft||0,c.top+(N.scrollTop||0)-(N.clientTop||0));e.preventDefault?e.preventDefault():e.returnValue=w}}function O(a){t===f.href&&(a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation(),t=0);b.removeEventListener("popstate",O,w);O=q}function z(a,e,c){var d=new A(2==a?"hashchange":3==a?"pagechange":"popstate");e!=
l&&(d.oldUrl=e);c!=l&&(d.newUrl=c);d.__history_shim__=n;if(!m&&a==l&&b.onpopstate)b.onpopstate(d);if(b.dispatchEvent)b.dispatchEvent(d);else{var f;if(a=k[d.type])for(var h in a)a.hasOwnProperty(h)&&("function"==typeof(f=a[h])||f&&"object"==typeof f&&(f=f.handleEvent))&&f.call(b,d)}}function P(a){return E?a?E.setItem("__history_shim__",fa(a)):ga(E.getItem("__history_shim__"))||{}:{}}function F(a,e,c){return G?(G(a,e),a):c?a:l}var b=this,d=b.JSON||{},ga=d.parse,fa=d.stringify,B=document,N=B.documentElement,
A=b.j,H=Function.prototype.bind||w,Q=Function.prototype.call,$=H.call(Q,Object.prototype.hasOwnProperty),x=b.history||{},g=(d=b.history)&&(d=d.__proto__||(d=d.constructor)&&d.prototype)&&d&&d!=Object.prototype&&d||b.history,f=b.location,m="pushState"in x,ha=m&&x.state===l,t=f.href,aa=x.pushState,ba=x.replaceState,E=b.sessionStorage,G;if(d=Object.defineProperty&&function(a,e){var c,b;for(b in e)$(e,b)&&(c=e[b],"object"!=typeof c&&(c={value:c}),"configurable"in c||(c.configurable=n),Object.defineProperty(a,
b,c))}){try{d(g,{_:{get:function(){return 1},configurable:n}})}catch(ka){d=q}1!==g._&&(d=q);"_"in g&&delete g._}!d&&g.__defineGetter__&&(d=function(a,e){var c,b;if(a.__defineGetter__)for(b in e)$(e,b)&&(c=e[b],c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set));return a});G=d;var R=l,k,K=0,ia=/[^\/]+$/g,X=location.pathname.split("#")[0].split("?")[0],h,j=B.createElement("a"),ca,S,da,T,I,C,r,ja=/^[^#]*/;h=function(a,e){if(a){if(!m||R){var c=h(),b=c.e,d=c.i,g=a.charAt(0);a=/^(?:[\w0-9]+\:)?\/\//.test(a)?
"/"==g?d+a:a:d+"//"+c.h+("/"==g?a:"?"==g?b+a:"#"==g?b+c.f+a:b.replace(ia,"")+a)}}else if(a=f.href,!m||e)a=f.protocol+"//"+f.host+(-1!=a.indexOf("#")?"/":X)+(a.replace(ja,"")||"#").replace(/^#[\/]?(?:\/)?/,"");if(ca!==a){j.href=ca=a;C=j.port;I=j.host;r=j.pathname;if("http:"===j.protocol&&80==C||"https:"===j.protocol&&443==C)I=j.hostname,C="";r="/"==r.charAt(0)?r:"/"+r;S=r+j.search+j.hash;T=r+j.search;da=T+j.hash}return{a:j.protocol+"//"+I+S,i:j.protocol,h:I,k:j.hostname||f.hostname,l:C||f.port,e:r,
f:j.search,b:j.hash,d:S,c:T,g:da}};var g=!R&&g,y={state:{get:function(){return P()[this.location.href]||q}},length:{get:function(){return x.length}},location:{set:function(a){b.location.href=a},get:function(){return m?f:U}}},U={assign:function(a){f.assign(m||0!==a.indexOf("#")?a:"#"+h().c+a)},reload:f.reload,replace:function(a){f.replace(m||0!==a.indexOf("#")?a:"#"+h().c+a)},toString:function(){return this.href}},d={href:{set:function(a){f.href=a},get:function(){return h().a}},protocol:{set:function(a){f.protocol=
a},get:function(){return f.protocol}},host:{set:function(a){f.host=a},get:function(){return f.host}},hostname:{set:function(a){f.hostname=a},get:function(){return f.hostname}},port:{set:function(a){f.port=a},get:function(){return f.port}},pathname:{set:function(a){f.pathname=a},get:function(){return h().e}},search:{set:function(a){f.search=a},get:function(){return h().f}},hash:{set:function(a){a=0===a.indexOf("#")?a:"#"+a;var b=h();f.hash="#"+b.c+a},get:function(){return h().b}},origin:{}},ea=b.onpopstate||
q,D=b.onhashchange,M=0,Y=q,W=h(),L=W.a;b.addEventListener?b.addEventListener("hashchange",J,w):b.attachEvent("onhashchange",J);D===l&&setInterval(function(){J({})},100);D||(D=q);b.addEventListener&&(b.addEventListener("popstate",O,w),b.addEventListener("popstate",function(){t=0;M=1},w));g&&F(g,x.state===l?{state:y.state,location:y.location}:{location:y.location});var y=F,p;a:{var u=U;if(Object.defineProperty){try{if(Object.defineProperty(u,"_",{get:function(){return 1},configurable:n}),1===u._){delete u._;
p=u;break a}}catch(la){}p=document.createElement("a");for(var v in p)try{delete p[v],v in p&&p[v]&&(p[v]=q)}catch(ma){}for(v in u)p[v]=u[v]}else p=u}U=y(p,d);!("onpopstate"in b||F(b,{onhashchange:{get:function(){return D},set:function(a){D=a||q}},onpopstate:{get:function(){return ea},set:function(a){(ea=a||q)&&!m&&V()}}},n))&&!m&&(Y=setInterval(function(){b.onpopstate&&V()},100));m||(document.addEventListener?document.addEventListener("click",Z,w):document.attachEvent("onclick",Z));try{new A("click")}catch(na){A=
q}A||(A=function(a){var b;B.createEvent?(b=B.createEvent("Events"),b.initEvent(a,w,w)):(b=B.createEventObject(),b.type=a);return b});b.addEventListener||(k={popstate:{},hashchange:{}},k.onpopstate=k.popstate,k.onhashchange=k.hashchange,k.onpagechange=k.pagechange={},b.attachEvent=H.call(function(a,e,c){if(e in k){e=k[e];if(!(a=c.uuid))a=c.uuid="_"+ +new Date;e[a]||(e[a]=c)}else Q.call(a,b,e,c)},b,b.attachEvent),b.detachEvent=H.call(function(a,e,c){var d;e in k?(a=c.uuid)&&(d=k[e])&&delete d[a]:Q.call(a,
b,e,c)},b,b.detachEvent));g.pushState=function(a,b,c,d){var g=P(),j=h().a,k=c&&h(c);t=0;c=k?k.a:j;d&&g[j]&&delete g[j];if((!m||ha)&&E&&a)g[c]=a,P(g),a=q;aa&&ba?d?ba.call(this,a,b,c):aa.call(this,a,b,c):k&&k.d!=h().d&&(K=1,d?f.replace("#"+k.g):f.hash=k.g);a=h().c;if(!s||s!=a)z(3,s,a),s=a};g.replaceState=function(a,b,c){this.pushState(a,b,c,1)};g.emulate=!m;var s="",d=function(){var a=h().c;if(!s||s!=a)z(3,s,a),s=a};b.addEventListener?(b.addEventListener("popstate",d),b.addEventListener("hashchange",
d)):(b.attachEvent("popstate",d),b.attachEvent("hashchange",d));if(b.opera&&m&&(d=document.createElement("a"),g=d.__proto__))(d=Object.getOwnPropertyDescriptor(d,"href"))&&"get"in d&&Object.defineProperty(g,"href",function(a){this.get=function(){var d=this.getAttribute("href"),c;return d&&"/"==d[0]?(c=b.location,c=c.protocol+"//"+c.host,c+d):a.call(this)};return this}.call(d,d.get));d=R=F=G=H=y=d=g=g=q}.call(window);
