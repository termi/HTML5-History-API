/*
 Copyright 2011-2013, github.com/termi/HTML5-History-API, original by Dmitriy Pakhtinov ( spb.piksel@gmail.com ) */
void function(){"use strict";var k=void 0,m=!0,q=null,w=!1;
function D(a){if(!a.__history_shim__){var g=h();if(K)return L=g.a,K=0;var d=a.oldURL||L;a=L=a.newURL||g.a;var g=d.replace(/^.*?(#|$)/,""),b=a.replace(/^.*?(#|$)/,"");d!=a&&!M&&z(k);t=M=0;g!=b&&z(2,d,a)}}function W(){if(t&&!(t=0)&&X.e!==Y)clearInterval(Z),setTimeout(z,10)}function $(a){var g=a||c.event,d=g.target||g.srcElement;a="defaultPrevented"in g?g.defaultPrevented:g.returnValue===w;if(d&&("A"===d.nodeName&&!a)&&(a=h(d.getAttribute("href",2),m),a.b&&"#"!==a.b&&a.b===a.a.replace(h().a.split("#").shift(),
""))){history.location.hash=a.b;a=a.b.replace(/^#/,"");if((d=document.getElementById(a))&&d.id===a&&"A"===d.nodeName)d=d.getBoundingClientRect(),window.scrollTo(N.scrollLeft||0,d.top+(N.scrollTop||0)-(N.clientTop||0));g.preventDefault?g.preventDefault():g.returnValue=w}}function O(a){t===e.href&&(a.stopImmediatePropagation?a.stopImmediatePropagation():a.stopPropagation(),t=0);c.removeEventListener("popstate",O,w);O=q}function z(a,g,d){var b=new A(2==a?"hashchange":3==a?"pagechange":"popstate");g!=
k&&(b.oldUrl=g);d!=k&&(b.newUrl=d);b.__history_shim__=m;if(!n&&a==k&&c.onpopstate)c.onpopstate(b);if(c.dispatchEvent)c.dispatchEvent(b);else{var e;if(a=l[b.type])for(var h in a)a.hasOwnProperty(h)&&("function"==typeof(e=a[h])||e&&"object"==typeof e&&(e=e.handleEvent))&&e.call(c,b)}}function P(a){return E?a?E.setItem("__history_shim__",ja(a)):ka(E.getItem("__history_shim__"))||{}:{}}function F(a,g,d){return G?(G(a,g),a):d?a:k}function aa(a,g,d,b){var c=P(),j=h().a,f=d&&h(d);t=0;d=f?f.a:j;b&&c[j]&&
delete c[j];if((!n||la)&&E&&a)c[d]=a,P(c),a=q;Q&&H?b?H.call(this,a,g,d):ba&&"/"==f.d?(Q.call(this,a,g,d+"?"),H.call(this,a,g,d)):Q.call(this,a,g,d):f&&f.e!=h().e&&(K=1,b?e.replace("#"+f.g):e.hash=f.g);a=h().c;if(!p||p!=a)z(3,p,a),p=a}function ca(a,b,d){this.pushState(a,b,d,1)}var c=this,b,x=document,N=x.documentElement,R=Function.prototype.call,f=Function.prototype.bind||w,ma=x.documentMode&&/msie (\d+)/i.test(navigator.userAgent),ba=(b=c.opera)&&"function"==typeof(b=b.version)&&+b(),l;c.addEventListener||
(l={popstate:{},hashchange:{}},l.onpopstate=l.popstate,l.onhashchange=l.hashchange,l.onpagechange=l.pagechange={},b="attachEvent",c[b]=f.call(function(a,b,d){var e,f;if(b in l){f=l[b];if(!(e=d.uuid))e=d.uuid="_"+ +new Date;f[e]||(f[e]=d)}R.call(a,c,b,d,w)},c,c[b]),b="detachEvent",c[b]=f.call(function(a,b,d){var e,f;b in l&&(e=d.uuid)&&(f=l[b])&&delete f[e];R.call(a,c,b,d,w)},c,c[b]));b=c.JSON||{};var ka=b.parse,ja=b.stringify,A=c.j,da=f.call(R,Object.prototype.hasOwnProperty),r=c.history||{},f=(b=
c.history)&&(b=b.__proto__||(b=b.constructor)&&b.prototype)&&b&&b!=Object.prototype&&b||c.history,e=c.location,n="pushState"in r,la=n&&r.state===k,t=e.href,Q=r.pushState,H=r.replaceState,E=c.sessionStorage,G;if(b=Object.defineProperty&&function(a,b){var d,c;for(c in b)da(b,c)&&(d=b[c],"object"!=typeof d&&(d={value:d}),"configurable"in d||(d.configurable=m),Object.defineProperty(a,c,d))}){try{b(f,{_:{get:function(){return 1},configurable:m}})}catch(pa){b=q}1!==f._&&(b=q);"_"in f&&delete f._}!b&&f.__defineGetter__&&
(b=function(a,b){var d,c;if(a.__defineGetter__)for(c in b)da(b,c)&&(d=b[c],d.get&&a.__defineGetter__(c,d.get),d.set&&a.__defineSetter__(c,d.set));return a});G=b;var S=k,K=0,na=/[^\/]+$/g,Y=location.pathname.split("#")[0].split("?")[0],h,j=x.createElement("a"),ea,T,fa,U,I,B,s,oa=/^[^#]*/;h=function(a,b){if(a){if(!n||S||ma){var c=h(),f=c.d,l=c.i,p=a.charAt(0);a=/^(?:[\w0-9]+\:)?\/\//.test(a)?"/"==p?l+a:a:l+"//"+c.h+("/"==p?a:"?"==p?f+a:"#"==p?f+c.f+a:f.replace(na,"")+a)}}else if(a=e.href,!n||b)a=e.protocol+
"//"+e.host+(-1!=a.indexOf("#")?"/":Y)+(a.replace(oa,"")||"#").replace(/^#[\/]?(?:\/)?/,"");if(ea!==a){j.href=ea=a;B=j.port;I=j.host;s=j.pathname;if("http:"===j.protocol&&80==B||"https:"===j.protocol&&443==B)I=j.hostname,B="";s="/"==s.charAt(0)?s:"/"+s;T=s+j.search+j.hash;U=s+j.search;fa=U+j.hash}return{a:j.protocol+"//"+I+T,i:j.protocol,h:I,k:j.hostname||e.hostname,l:B||e.port,d:s,f:j.search,b:j.hash,e:T,c:U,g:fa}};b=!S&&f;var ga=w,y={state:{get:function(){return P()[this.location.href]||q}},length:{get:function(){return r.length}},
location:{set:function(a){c.location.href=a},get:function(){return n?e:V}}},V={assign:function(a){e.assign(n||0!==a.indexOf("#")?a:"#"+h().c+a)},reload:e.reload,replace:function(a){e.replace(n||0!==a.indexOf("#")?a:"#"+h().c+a)},toString:function(){return this.href}},f={href:{set:function(a){e.href=a},get:function(){return h().a}},protocol:{set:function(a){e.protocol=a},get:function(){return e.protocol}},host:{set:function(a){e.host=a},get:function(){return e.host}},hostname:{set:function(a){e.hostname=
a},get:function(){return e.hostname}},port:{set:function(a){e.port=a},get:function(){return e.port}},pathname:{set:function(a){e.pathname=a},get:function(){return h().d}},search:{set:function(a){e.search=a},get:function(){return h().f}},hash:{set:function(a){a=0===a.indexOf("#")?a:"#"+a;var b=h();n?e.hash="#"+b.c+a:a!=b.b&&((ga||r).pushState(q,q,b.c+a),ha({oldURL:b.a}))},get:function(){return h().b}},origin:{}},ha,ia=c.onpopstate||q,C=c.onhashchange,M=0,Z=q,X=h(),L=X.a;c.addEventListener?c.addEventListener("hashchange",
D,w):c.attachEvent("onhashchange",D);C===k&&setInterval(function(){D({})},100);C||(C=q);c.addEventListener&&n&&(c.addEventListener("popstate",O,w),c.addEventListener("popstate",function(a){t=0;M=1;ba&&H.call(r,a.state,document.title,location.href)},w));b&&F(b,r.state===k?{state:y.state,location:y.location}:{location:y.location});var y=F,u;a:{var v=V;if(Object.defineProperty){try{if(Object.defineProperty(v,"_",{get:function(){return 1},configurable:m}),1===v._){delete v._;u=v;break a}}catch(qa){}u=
document.createElement("a");for(var J in u)try{delete u[J]}catch(ra){}for(J in v)u[J]=v[J]}else u=v}V=y(u,f);!("onpopstate"in c||F(c,{onhashchange:{get:function(){return C},set:function(a){C=a||q}},onpopstate:{get:function(){return ia},set:function(a){(ia=a||q)&&!n&&W()}}},m))&&!n&&(Z=setInterval(function(){c.onpopstate&&W()},100));n||(document.addEventListener?document.addEventListener("click",$,w):document.attachEvent("onclick",$));ha=D;try{new A("click")}catch(sa){A=q}A||(A=function(a){var b;x.createEvent?
(b=x.createEvent("Events"),b.initEvent(a,w,w)):(b=x.createEventObject(),b.type=a);return b});b.pushState=aa;b.replaceState=ca;b.emulate=!n;var p=h().c;b=function(){var a=h().c;if(!p||p!=a)z(3,p,a),p=a};c.addEventListener?(c.addEventListener("popstate",b,w),c.addEventListener("hashchange",b,w)):(c.attachEvent("popstate",b,w),c.attachEvent("hashchange",b,w));b=S=F=G=f=ga=y=f=f=b=aa=ca=q}.call(window);
